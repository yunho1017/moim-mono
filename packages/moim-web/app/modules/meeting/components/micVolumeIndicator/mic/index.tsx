import * as React from "react";
import { DefaultTheme, ThemeContext } from "styled-components";
import { SvgProps, StyledSvg } from "./styled";

export interface MicrophoneProps extends SvgProps {
  /** Whether or not should show muted status. */
  muted?: boolean;
  /** Whether or not should show poor connected status. */
  poorConnection?: boolean;
  /** Title attribute for the icon when muted, it defaults to `Muted microphone` */
  mutedTitle?: string;
  /** Title attribute for the icon when unmuted, it defaults to `Microphone` */
  unmutedTitle?: string;
  hostMuted?: boolean;
  iconColorSwitch?: "original" | "white";
}

function getPath(
  muted: boolean,
  hostMuted: boolean,
  poorConnection: boolean,
  theme: DefaultTheme,
  iconColorSwitch: "original" | "white",
) {
  if (hostMuted) {
    return (
      <path
        d="M9,0 C13.9705627,0 18,4.02943725 18,9 C18,13.9705627 13.9705627,18 9,18 C4.02943725,18 0,13.9705627 0,9 C0,4.02943725 4.02943725,0 9,0 Z M14.9546207,3.94618239 L11.395,7.505 L11.3959044,8.36061793 C11.3959044,9.84091169 10.3232215,11.0409269 9,11.0409269 C8.67036218,11.0409269 8.35627268,10.9664544 8.07044197,10.8317288 L7.26895543,11.6319677 C7.64220929,11.8397136 8.06120435,11.9755126 8.50748651,12.0203702 L8.69025667,12.033544 L8.83617747,12.0367586 L9.16382253,12.0367586 C10.8310287,12.0367586 12.2109379,10.7697557 12.3749598,9.13792394 L12.3881336,8.95515379 L12.3913481,8.80923298 L12.3913481,8.64541045 C12.3913481,8.31303117 12.6607948,8.04358452 12.9931741,8.04358452 C13.2616146,8.04358452 13.4922142,8.22031563 13.5688602,8.47239624 L13.590159,8.57026046 L13.595,8.64541045 L13.595,8.80923298 C13.595,11.0560002 11.9165862,12.9305577 9.72105018,13.2057192 L9.601,13.217 L9.60182594,15.3416562 C9.60182594,15.6075596 9.42938008,15.8331862 9.19022354,15.9128006 L9.09761929,15.9356052 L9,15.9434821 C8.73155942,15.9434821 8.50095985,15.766751 8.42431391,15.5146704 L8.40301504,15.4168062 L8.39817406,15.341662 L8.398,13.217 L8.27725758,13.2054983 C7.5866402,13.1186222 6.94644617,12.8731645 6.3935731,12.5071098 L3.94618239,14.9546207 C5.30832286,16.1118396 7.07262938,16.81 9,16.81 C13.3133439,16.81 16.81,13.3133439 16.81,9 C16.81,7.07262938 16.1118396,5.30832286 14.9546207,3.94618239 Z M9,1.19 C4.6866561,1.19 1.19,4.6866561 1.19,9 C1.19,10.9574039 1.91008809,12.7466221 3.09980984,14.1172004 L5.49648959,11.7213758 C4.93681246,11.0796697 4.5592804,10.275589 4.44296829,9.39053851 L4.42008158,9.17627723 L4.40775184,8.96642942 L4.405,8.64541045 C4.405,8.31303117 4.67444665,8.04358452 5.00682594,8.04358452 C5.27526652,8.04358452 5.50586609,8.22031563 5.58251203,8.47239624 L5.6038109,8.57026046 L5.60865188,8.64541045 L5.60865188,8.80923298 C5.60865188,9.59014104 5.88662242,10.3080184 6.34985448,10.8674414 L7.15129381,10.0656655 C6.80944989,9.60233234 6.60409556,9.00830338 6.60409556,8.36061793 L6.60409556,5.68030896 C6.60409556,4.2000152 7.67677852,3 9,3 C10.3232215,3 11.3959044,4.2000152 11.3959044,5.68030896 L11.395,5.821 L14.1172004,3.09980984 C12.7466221,1.91008809 10.9574039,1.19 9,1.19 Z"
        fill={
          iconColorSwitch === "white"
            ? theme.color.white1000
            : theme.colorV2.colorSet.grey600
        }
      />
    );
  }

  if (muted) {
    return poorConnection ? (
      <path d="M4.146 4.146c.196-.195.513-.195.708 0L9.168 8.46h.018l.813.815v.018l5.854 5.854c.002-.005.005-.008.008-.01l.724.724-.008.01 3.276 3.275c.195.195.195.512 0 .707-.098.098-.226.147-.354.147-.127 0-.255-.049-.352-.146l-3.281-3.281C14.82 17.459 13.475 18 11.998 18c-3.308 0-6-2.691-6-6 0-.277.224-.5.5-.5.278 0 .5.223.5.5 0 2.757 2.244 5 5 5 1.2 0 2.29-.436 3.147-1.146l-1.439-1.438c-.14.105-.287.207-.445.285l-.447-.895c.062-.03.116-.073.174-.11l-2.99-2.989v.941H9v-1.063h.88L4.147 4.853c-.196-.194-.196-.511 0-.707zM14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5zm3-7.5c.276 0 .5.224.5.5 0 1.106-.307 2.14-.83 3.031l-.748-.748c.357-.687.578-1.456.578-2.283 0-.276.224-.5.5-.5zm-6.293 2.317c.25.121.517.183.793.183l.016 1.001-.098-.008c-.359-.012-.76-.089-1.147-.275zm-1.085-1.278c.093.282.234.536.42.757l-.766.644c-.267-.319-.47-.685-.603-1.089zM15 11.618v.155c0 .325-.051.643-.139.95l-.867-.868c.001-.027.006-.055.006-.082v-.155h1zm0-2.126v1.062h-1V9.492h1zm0-2.125v1.062h-1V7.367h1zM9.155 6.201l.955.297c-.073.235-.11.48-.11.73v.17h-.463l-.512-.512c.024-.232.061-.463.13-.685zm5.079-1.128c.268.321.469.689.599 1.093l-.951.307c-.091-.283-.231-.537-.415-.759zm-3.514-.765l.453.891c-.246.126-.474.312-.656.535l-.776-.63c.274-.338.603-.604.979-.796zM12 4c.434 0 .853.098 1.245.29l-.44.897C12.553 5.064 12.282 5 12 5l-.031-1z" />
    ) : (
      <>
        <path
          d="M13.68 8.02c.3 0 .549.223.588.513l.006.08v.193a5.08 5.08 0 0 1-4.679 5.064v2.588a.594.594 0 0 1-1.182.08l-.005-.08V13.87a5.08 5.08 0 0 1-4.675-4.882l-.003-.182v-.192a.594.594 0 0 1 1.182-.08l.006.08v.192a3.892 3.892 0 0 0 3.718 3.888l.174.004h.384a3.892 3.892 0 0 0 3.888-3.72l.004-.172v-.192c0-.328.266-.594.594-.594zM9.002 2c1.55 0 2.807 1.406 2.807 3.14v3.14c0 1.734-1.257 3.14-2.807 3.14s-2.807-1.406-2.807-3.14V5.14C6.195 3.406 7.452 2 9.002 2z"
          fill={
            iconColorSwitch === "white"
              ? theme.color.white1000
              : theme.colorV2.colorSet.grey600
          }
          fillRule="evenodd"
        />
        <path
          d="M13.11 2.17a.594.594 0 0 1 .897.774l-.057.066L3.874 13.087a.594.594 0 0 1-.898-.774l.058-.066L13.11 2.17z"
          fill={theme.color.red700}
        />
      </>
    );
  }

  return poorConnection ? (
    <path d="M14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h5zm3-7.5c.276 0 .5.224.5.5 0 3.309-2.691 6-6 6s-6-2.691-6-6c0-.276.224-.5.5-.5s.5.224.5.5c0 2.757 2.243 5 5 5s5-2.243 5-5c0-.276.224-.5.5-.5zm-6.293 2.318c.25.12.517.183.793.183l.013.958v-.46l.085.492H12.014c-.486-.002-.876-.096-1.242-.274l.435-.9zm2.268-.543l.77.637c-.275.335-.606.6-.983.79l-.447-.896c.25-.125.473-.303.66-.53zm-3.353-.736c.093.283.235.537.42.757l-.765.645c-.268-.32-.472-.687-.604-1.09l.949-.312zM15 11.619v.155c0 .359-.053.71-.16 1.043l-.953-.305c.075-.233.113-.482.113-.738v-.155h1zm-5-1.033v1.063H9v-1.063h1zm5-1.093v1.063h-1V9.492h1zm-5-1.03v1.062H9V8.46h1zm5-1.095V8.43h-1V7.367h1zM9.156 6.2l.955.3c-.074.232-.111.478-.111.728v.17H9v-.17c0-.351.053-.696.156-1.027zm5.08-1.127c.267.32.468.688.598 1.093l-.951.306c-.091-.282-.23-.537-.415-.759l.768-.64zm-3.516-.766l.453.891c-.246.126-.473.311-.656.535l-.775-.63c.273-.337.602-.603.978-.795zM12 4c.433 0 .852.098 1.245.29l-.44.899C12.55 5.064 12.28 5 12 5l-.031-1h.03z" />
  ) : (
    <path
      d="M13.68 8.02c.3 0 .549.223.588.513l.006.08v.193a5.08 5.08 0 0 1-4.679 5.064v2.588a.594.594 0 0 1-1.182.08l-.005-.08V13.87a5.08 5.08 0 0 1-4.675-4.882l-.003-.182v-.192a.594.594 0 0 1 1.182-.08l.006.08v.192a3.892 3.892 0 0 0 3.718 3.888l.174.004h.384a3.892 3.892 0 0 0 3.888-3.72l.004-.172v-.192c0-.328.266-.594.594-.594zM9.002 2c1.55 0 2.807 1.406 2.807 3.14v3.14c0 1.734-1.257 3.14-2.807 3.14s-2.807-1.406-2.807-3.14V5.14C6.195 3.406 7.452 2 9.002 2z"
      fill={
        iconColorSwitch === "white"
          ? theme.color.white1000
          : theme.colorV2.colorSet.grey600
      }
      fillRule="evenodd"
    />
  );
}

const Microphone: React.SFC<MicrophoneProps> = ({
  muted = false,
  poorConnection = false,
  hostMuted = false,
  mutedTitle = "Muted microphone",
  unmutedTitle = "Microphone",
  iconColorSwitch = "original",
  ...rest
}) => {
  const theme = React.useContext(ThemeContext);
  const iconPath = getPath(
    muted,
    hostMuted,
    poorConnection,
    theme,
    iconColorSwitch,
  );

  return (
    <StyledSvg
      {...rest}
      muted={muted}
      poorConnection={poorConnection}
      title={muted ? mutedTitle : unmutedTitle}
      data-testid={
        poorConnection ? "poor-connection-mic" : "good-connection-mic"
      }
    >
      {iconPath}
    </StyledSvg>
  );
};

Microphone.displayName = "Microphone";

export default Microphone;
